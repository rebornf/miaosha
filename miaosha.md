# miaosha
高并发秒杀商城
这个项目主要是针对处理高并发问题。主要考虑的问题有以下几个方面：
一、正确性。核心问题就是防止超卖，和重复下单。
二、高并发。主要是采用Redis进行缓存常用查询、消息队列异步下单、页面资源静态化等方面减去数据库压力。
三、安全性。主要有动态地址生成和接口放刷，双重MD5加密密码。
四、高可用性。 为防止redsi服务器宕机，使用限流来防止mysql承受过多的请求。

秒杀流程、画架构图
	1、登录进入商品列表页面，静态资源缓存
	2、点击进入商品详情页面，静态资源缓存，ajax获取验证码(服务器生成三个数的预算，并将结果缓存到redis);
	3、点击秒杀, 将验证码结果和商品ID传给后端，如果结果正确。动态生成随机串UUID,结合用户ID和商品ID存入redis，并将path传给前端。前端获取path后，再根据path地址调用秒杀服务；
	4、服务端获取请求的path参数，去查缓存是否在；
	5、如果存在，预减redis库存，如果还有库存，看是否已经生成订单，没有的话就将请求入消息队列。
	6、从消息队列中取消息：获取商品Id和用户ID,判断库存，重复下单；然后下单。
	7、下单：减库存，生成订单； 
	8、前端轮询订单生成结果。50ms继续轮询或者秒杀是否成功和失败;
